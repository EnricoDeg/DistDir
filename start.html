<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DistDir: Getting started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DistDir
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Getting started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#init">Initialization</a></li>
<li class="level1"><a href="#idxlist">Index list</a></li>
<li class="level1"><a href="#map">Map</a></li>
<li class="level1"><a href="#exchange">Exchange</a></li>
<li class="level1"><a href="#finalization">Finalization and clean up</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="init"></a>
Initialization</h1>
<p>First of all, the library needs to be initialized with a call to <code>distdir_initialize</code>.</p>
<p>This function internally calls <code>MPI_Init</code> and configure the library.</p>
<h1><a class="anchor" id="idxlist"></a>
Index list</h1>
<p>The user needs to provide index lists with global indices. For each exchange, two index lists need to be created, one with the indices to be sent and one with the indices to be received.</p>
<p>The API function <code>new_idxlist</code> requires an integer array with the global indices and its size and it returns a <a class="el" href="structt__idxlist.html" title="The structure contains information about an index list.">t_idxlist</a> object.</p>
<p>In case of unidirectional exchange, the source or receiver index list should be empty. An empty index list can be created with a call to <code>new_idxlist_empty</code> .</p>
<h1><a class="anchor" id="map"></a>
Map</h1>
<p>Once the index lists are correcty created, most of the effort on the user side is done and the library can create a map between all processes involved in the exchange based on the source and receiver index lists.</p>
<p>The mapping is done internally using a basic distributed directory algorithm. The mapping is done with a call to the API function <code>new_map</code> which requires the source and receiver index lists and the MPI communicator. An additional parameter can be provided which helps to optimally set up the distributed directory, but a negative value can be provided to use default values internally. A detailed explanation about this additional parameter is given in the next page and it is particularly useful to exchange 3D fields.</p>
<p>The function returns a <a class="el" href="structt__map.html">t_map</a> object which is agnostic about the data types of the fields involved in the actual exchange. The object holds information about the ranks from which the indices needs to be received and the ranks to which the indices need to be sent.</p>
<h1><a class="anchor" id="exchange"></a>
Exchange</h1>
<p>A exchanger object needs to be created to specialize the computed map for a specific field or group of fields with the same exchange pattern and the same data type. The API function <code>new_exchanger</code> requires a <a class="el" href="structt__map.html">t_map</a> object and a MPI data type in order to return a <a class="el" href="structt__exchanger.html">t_exchanger</a> object.</p>
<p>Once the exchanger object is created, the exchange is set up and it can be triggered with a call to <code>exchanger_go</code> which requires the <a class="el" href="structt__exchanger.html">t_exchanger</a> object and the source and receiver pointers to the data in memory. Ideally, this is the only function call of the API which is used in the time loop of an application.</p>
<h1><a class="anchor" id="finalization"></a>
Finalization and clean up</h1>
<p>Each object created during the set up of an exchange needs to be destroyed.</p>
<p>The <a class="el" href="structt__idxlist.html" title="The structure contains information about an index list.">t_idxlist</a> object is only needed for the mapping, so it can ideally already destroyed during the initialization phase. This is achieved with a call to <code>delete_idxlist</code>.</p>
<p>The <a class="el" href="structt__map.html">t_map</a> object is needed for the actual exchange, so it should be deleted in the finalization step of an application. This is achieved with a call to <code>delete_map</code>. Same principle can be applied to the <a class="el" href="structt__exchanger.html">t_exchanger</a> object which can be destroyed with a call to <code>delete_exchanger</code>.</p>
<p>Finally, the library can be finalized with a call to <code>distdir_finalize</code>. The function internally clean up the memory for the library configuration and call <code>MPI_Finalize</code> if not already done. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
